<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel Digital</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

<style>
:root{
  --neon: #f2f2f2;
  --neon-top: #00ff6a;
}
body{
  margin:0;
  background:black;
  color:var(--neon);
  font-family:'Roboto', sans-serif;
  display:flex;
  flex-direction:column;
  height:100vh;
}
.top{display:flex;justify-content:center;padding:20px;color:var(--neon-top);}
.top-inner{display:flex;flex-direction:column;align-items:center;gap:6px;}
.oil-box{display:flex;align-items:center;gap:8px;font-size:16px;}
.oil-info{font-size:13px;opacity:.8;}
.center{flex:1;display:flex;flex-direction:column;justify-content:center;align-items:center;}
.center-label{font-size:4vw;}
.center-value{font-family:'Orbitron', monospace;font-size:16vw;}
.bottom{display:flex;justify-content:space-around;margin-bottom:15px;}
.controls{display:flex;justify-content:center;gap:12px;margin-bottom:20px;}
button,input{
  background:black;color:var(--neon);
  border:2px solid var(--neon);
  padding:10px 20px;
  font-size:16px;
  font-family:'Orbitron', monospace;
}
input{width:120px;}
@keyframes blink{50%{opacity:.3}}
.oil-danger circle{animation:blink 1s infinite;}
</style>
</head>

<body>

<div class="top">
  <div class="top-inner">
    <div id="clock"></div>

    <div class="oil-box">
      <span id="oilIcon">
        <svg width="14" height="14" viewBox="0 0 20 20">
          <circle cx="10" cy="10" r="8"/>
        </svg>
      </span>
      <span id="oilStatus"></span>
    </div>

    <div class="oil-info" id="oilInfo"></div>
    <button onclick="resetOil()">Troquei o óleo</button>
  </div>
</div>

<div class="center">
  <div class="center-label">ODÔMETRO TOTAL</div>
  <div class="center-value" id="totalKmCenter"></div>
</div>

<div class="bottom">
  <div>Tempo<br><span id="moveTime">00:00</span></div>
  <div>
    KM Corrida<br>
    <input id="manualKm" type="number" step="0.1" placeholder="Ex: 7.4"><br>
    <button onclick="addManualKm()">Adicionar KM</button>
  </div>
</div>

<div class="controls">
  <button onclick="start()">INICIAR</button>
  <button onclick="stop()">PARAR</button>
</div>

<div class="controls">
  <button onclick="ajustarOdometro()">AJUSTAR ODÔMETRO</button>
</div>

<script>
/* RELÓGIO */
setInterval(()=>clock.textContent=new Date().toLocaleTimeString('pt-BR'),1000);

/* ODOMETRO */
let totalKm = Number(localStorage.getItem('totalKm')) || 2105.2;
totalKmCenter.textContent = totalKm.toFixed(1);

/* TEMPO */
let sec=0,timer=null;
function start(){
 if(timer)return;
 timer=setInterval(()=>{
  sec++;
  moveTime.textContent=
   String(Math.floor(sec/60)).padStart(2,'0')+':'+
   String(sec%60).padStart(2,'0');
 },1000);
}
function stop(){clearInterval(timer);timer=null;}

/* KM MANUAL */
function addManualKm(){
 const v=parseFloat(manualKm.value);
 if(isNaN(v)||v<=0)return;
 totalKm+=v;
 localStorage.setItem('totalKm',totalKm);
 totalKmCenter.textContent=totalKm.toFixed(1);
 manualKm.value='';
 updateOil();
}

/* ÓLEO */
const OIL_LIMIT = 1500;
const DEFAULT_OIL_BASE_KM = 1522;

let oilBaseKmStored = localStorage.getItem('oilBaseKm');
let oilBaseKm = oilBaseKmStored !== null
  ? Number(oilBaseKmStored)
  : DEFAULT_OIL_BASE_KM;

function updateOil(){
 const restante=(oilBaseKm+OIL_LIMIT)-totalKm;
 const circle=oilIcon.querySelector('circle');
 oilIcon.classList.remove('oil-danger');

 if(restante<=0){
  oilStatus.textContent='troca de óleo atrasada';
  oilInfo.textContent=`Atraso: ${Math.abs(restante).toFixed(1)} km`;
  circle.setAttribute('fill','#ff3b3b');
  oilIcon.classList.add('oil-danger');
 }else if(restante<=500){
  oilStatus.textContent='troca de óleo próxima';
  oilInfo.textContent=`Faltam: ${restante.toFixed(1)} km`;
  circle.setAttribute('fill','#ffff00');
 }else{
  oilStatus.textContent='pode rodar tranquilo';
  oilInfo.textContent=`Faltam: ${restante.toFixed(1)} km`;
  circle.setAttribute('fill','#00ff6a');
 }
}

function resetOil(){
 oilBaseKm=totalKm;
 localStorage.setItem('oilBaseKm',oilBaseKm);
 updateOil();
 alert('Troca de óleo registrada');
}

function ajustarOdometro(){
 const n=prompt('Novo valor do odômetro:',totalKm.toFixed(1));
 if(!n)return;
 totalKm=Number(n.replace(',','.'));
 localStorage.setItem('totalKm',totalKm);
 totalKmCenter.textContent=totalKm.toFixed(1);
 updateOil();
}

updateOil();
</script>

</body>
</html>
